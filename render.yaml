services:
  - type: web
    name: ultimate-colab-keeper
    env: python
    region: oregon
    plan: free
    buildCommand: |
      pip install -r requirements.txt
      apt-get update && apt-get install -y wget gnupg unzip
      wget -q -O - https://dl.google.com/linux/linux_signing_key.pub | apt-key add -
      echo "deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main" >> /etc/apt/sources.list.d/google.list
      apt-get update && apt-get install -y google-chrome-stable
      CHROME_VERSION=$(google-chrome --version | cut -d ' ' -f3)
      wget -O /tmp/chromedriver.zip "https://chromedriver.storage.googleapis.com/${CHROME_VERSION}/chromedriver_linux64.zip"
      unzip /tmp/chromedriver.zip -d /usr/local/bin/
      chmod +x /usr/local/bin/chromedriver
    startCommand: gunicorn ultimate_colab_keeper:app
    envVars:
      - key: COLAB_URL
        value: https://colab.research.google.com/drive/1jckV8xUJSmLhhol6wZwVJzpybsimiRw1?usp=sharing
      - key: GOOGLE_EMAIL
        sync: false
      - key: GOOGLE_PASSWORD
        sync: false
      - key: GOOGLE_CHROME_BIN
        value: /usr/bin/google-chrome
